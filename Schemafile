# -*- mode: ruby -*-
# vi: set ft=ruby :

create_table :book_reviews, force: :cascade, options: 'ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin ROW_FORMAT=DYNAMIC' do |t|
  t.integer :loan_id, null: false
  t.integer :star
  t.text :comment, null: false
  t.timestamps null: false
  t.index :loan_id
end

create_table :libraries, force: :cascade, options: 'ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin ROW_FORMAT=DYNAMIC' do |t|
  t.string :name, null: false
  t.datetime :created_at, null: false
  t.datetime :updated_at, null: false
  t.string :crawler
end

create_table :library_users, force: :cascade, options: 'ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin ROW_FORMAT=DYNAMIC' do |t|
  t.integer :user_id, null: false
  t.integer :library_id, null: false
  t.string :sign_in_id, null: false
  t.string :password, null: false
  t.integer :sign_in_count, default: 0, null: false
  t.datetime :last_sign_in_at
  t.datetime :created_at, null: false
  t.datetime :updated_at, null: false
  t.index [:user_id, :library_id], unique: true
end

create_table :loans, force: :cascade, options: 'ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin ROW_FORMAT=DYNAMIC' do |t|
  t.integer :user_id, null: false, default: 0
  t.integer :library_id, null: false, default: 0
  t.date :started_at, null: false
  t.date :ended_at, null: false
  t.string :place_name, null: false, default: ''
  t.string :book_title, null: false
  t.string :isbn, null: false, default: ''
  t.datetime :last_fetched_at
  t.boolean :returned, null: false, default: false
  t.datetime :created_at, null: false
  t.datetime :updated_at, null: false
end

create_table :users, force: :cascade, options: 'ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin ROW_FORMAT=DYNAMIC' do |t|
  t.string :email, default: "", null: false
  t.string :encrypted_password, default: "", null: false
  t.string :reset_password_token
  t.datetime :reset_password_sent_at
  t.datetime :remember_created_at
  t.integer :sign_in_count, default: 0, null: false
  t.datetime :current_sign_in_at
  t.datetime :last_sign_in_at
  t.string :current_sign_in_ip
  t.string :last_sign_in_ip
  t.datetime :created_at, null: false
  t.datetime :updated_at, null: false
  t.index [:email]
  t.index [:reset_password_token], unique: true
end
